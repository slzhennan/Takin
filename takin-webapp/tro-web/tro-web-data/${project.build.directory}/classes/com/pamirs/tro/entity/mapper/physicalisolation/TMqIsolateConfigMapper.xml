<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~ Copyright 2021 Shulie Technology, Co.Ltd
  ~ Email: shulie@shulie.io
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~      http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
        namespace="com.pamirs.tro.entity.dao.physicalisolation.TMqIsolateConfigMapper">
    <resultMap id="BaseResultMap"
               type="com.pamirs.tro.entity.domain.entity.MqIsolateConfig">
        <!-- WARNING - @mbggenerated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        <constructor>
            <idArg column="ID" javaType="java.lang.Long" jdbcType="BIGINT"/>
            <arg column="CLUSTER_NAME" javaType="java.lang.String"
                 jdbcType="VARCHAR"/>
            <arg column="CLUSTER_ALIAS" javaType="java.lang.String"
                 jdbcType="VARCHAR"/>
            <arg column="NAMESRV_ADDR" javaType="java.lang.String"
                 jdbcType="VARCHAR"/>
            <arg column="PT_NAMESRV_ADDR" javaType="java.lang.String"
                 jdbcType="VARCHAR"/>
            <arg column="BROKER_NAME" javaType="java.lang.String"
                 jdbcType="VARCHAR"/>
            <arg column="TOPIC" javaType="java.lang.String"
                 jdbcType="VARCHAR"/>
            <arg column="CONSUMER_GROUP" javaType="java.lang.String"
                 jdbcType="VARCHAR"/>
            <arg column="ISOLATED_STATUS" javaType="java.lang.Integer"
                 jdbcType="INTEGER"/>
            <arg column="BROKER_PROPERTY" javaType="java.lang.String"
                 jdbcType="VARCHAR"/>
            <arg column="ACTIVE" javaType="java.lang.String" jdbcType="CHAR"/>
            <arg column="CREATE_TIME" javaType="java.util.Date"
                 jdbcType="TIMESTAMP"/>
            <arg column="UPDATE_TIME" javaType="java.util.Date"
                 jdbcType="TIMESTAMP"/>
        </constructor>
    </resultMap>
    <resultMap id="ResultMapWithBLOBs"
               type="com.pamirs.tro.entity.domain.entity.MqIsolateConfig">
        <!-- WARNING - @mbggenerated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        <constructor>
            <idArg column="ID" javaType="java.lang.Long" jdbcType="BIGINT"/>
            <arg column="CLUSTER_NAME" javaType="java.lang.String"
                 jdbcType="VARCHAR"/>
            <arg column="CLUSTER_ALIAS" javaType="java.lang.String"
                 jdbcType="VARCHAR"/>
            <arg column="NAMESRV_ADDR" javaType="java.lang.String"
                 jdbcType="VARCHAR"/>
            <arg column="PT_NAMESRV_ADDR" javaType="java.lang.String"
                 jdbcType="VARCHAR"/>
            <arg column="BROKER_NAME" javaType="java.lang.String"
                 jdbcType="VARCHAR"/>
            <arg column="TOPIC" javaType="java.lang.String"
                 jdbcType="VARCHAR"/>
            <arg column="CONSUMER_GROUP" javaType="java.lang.String"
                 jdbcType="VARCHAR"/>
            <arg column="ISOLATED_STATUS" javaType="java.lang.Integer"
                 jdbcType="INTEGER"/>
            <arg column="BROKER_PROPERTY" javaType="java.lang.String"
                 jdbcType="VARCHAR"/>
            <arg column="ACTIVE" javaType="java.lang.String" jdbcType="CHAR"/>
            <arg column="CREATE_TIME" javaType="java.util.Date"
                 jdbcType="TIMESTAMP"/>
            <arg column="UPDATE_TIME" javaType="java.util.Date"
                 jdbcType="TIMESTAMP"/>
            <arg column="FAILED_DETAIL" javaType="java.lang.String"
                 jdbcType="LONGVARCHAR"/>
        </constructor>
    </resultMap>
    <sql id="Base_Column_List">
        <!-- WARNING - @mbggenerated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        ID, CLUSTER_NAME, CLUSTER_ALIAS, NAMESRV_ADDR, PT_NAMESRV_ADDR,
        BROKER_NAME, TOPIC,
        CONSUMER_GROUP, ISOLATED_STATUS, BROKER_PROPERTY, ACTIVE, CREATE_TIME, UPDATE_TIME
    </sql>
    <sql id="Blob_Column_List">
        <!-- WARNING - @mbggenerated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        FAILED_DETAIL
    </sql>
    <select id="selectByPrimaryKey" parameterType="java.lang.Long"
            resultMap="ResultMapWithBLOBs">
        <!-- WARNING - @mbggenerated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        select
        <include refid="Base_Column_List"/>
        ,
        <include refid="Blob_Column_List"/>
        from t_mq_isolate_config
        where ID = #{id,jdbcType=BIGINT}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
        <!-- WARNING - @mbggenerated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        delete from t_mq_isolate_config
        where ID = #{id,jdbcType=BIGINT}
    </delete>
    <insert id="insert"
            parameterType="com.pamirs.tro.entity.domain.entity.MqIsolateConfig">
        <!-- WARNING - @mbggenerated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        insert into t_mq_isolate_config (ID, CLUSTER_NAME, CLUSTER_ALIAS,
        NAMESRV_ADDR, PT_NAMESRV_ADDR, BROKER_NAME,
        TOPIC, CONSUMER_GROUP, ISOLATED_STATUS,
        BROKER_PROPERTY, ACTIVE, CREATE_TIME,
        UPDATE_TIME, FAILED_DETAIL)
        values (#{id,jdbcType=BIGINT}, #{clusterName,jdbcType=VARCHAR},
        #{clusterAlias,jdbcType=VARCHAR},
        #{namesrvAddr,jdbcType=VARCHAR}, #{ptNamesrvAddr,jdbcType=VARCHAR}, #{brokerName,jdbcType=VARCHAR},
        #{topic,jdbcType=VARCHAR}, #{consumerGroup,jdbcType=VARCHAR},
        #{isolatedStatus,jdbcType=INTEGER},
        #{brokerProperty,jdbcType=VARCHAR}, #{active,jdbcType=CHAR},
        #{createTime,jdbcType=TIMESTAMP},
        #{updateTime,jdbcType=TIMESTAMP}, #{failedDetail,jdbcType=LONGVARCHAR})
    </insert>
    <insert id="insertSelective"
            parameterType="com.pamirs.tro.entity.domain.entity.MqIsolateConfig">
        <!-- WARNING - @mbggenerated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        insert into t_mq_isolate_config
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">
                ID,
            </if>
            <if test="clusterName != null">
                CLUSTER_NAME,
            </if>
            <if test="clusterAlias != null">
                CLUSTER_ALIAS,
            </if>
            <if test="namesrvAddr != null">
                NAMESRV_ADDR,
            </if>
            <if test="ptNamesrvAddr != null">
                PT_NAMESRV_ADDR,
            </if>
            <if test="brokerName != null">
                BROKER_NAME,
            </if>
            <if test="topic != null">
                TOPIC,
            </if>
            <if test="consumerGroup != null">
                CONSUMER_GROUP,
            </if>
            <if test="isolatedStatus != null">
                ISOLATED_STATUS,
            </if>
            <if test="brokerProperty != null">
                BROKER_PROPERTY,
            </if>
            <if test="active != null">
                ACTIVE,
            </if>
            <if test="createTime != null">
                CREATE_TIME,
            </if>
            <if test="updateTime != null">
                UPDATE_TIME,
            </if>
            <if test="failedDetail != null">
                FAILED_DETAIL,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="id != null">
                #{id,jdbcType=BIGINT},
            </if>
            <if test="clusterName != null">
                #{clusterName,jdbcType=VARCHAR},
            </if>
            <if test="clusterAlias != null">
                #{clusterAlias,jdbcType=VARCHAR},
            </if>
            <if test="namesrvAddr != null">
                #{namesrvAddr,jdbcType=VARCHAR},
            </if>
            <if test="ptNamesrvAddr != null">
                #{ptNamesrvAddr,jdbcType=VARCHAR},
            </if>
            <if test="brokerName != null">
                #{brokerName,jdbcType=VARCHAR},
            </if>
            <if test="topic != null">
                #{topic,jdbcType=VARCHAR},
            </if>
            <if test="consumerGroup != null">
                #{consumerGroup,jdbcType=VARCHAR},
            </if>
            <if test="isolatedStatus != null">
                #{isolatedStatus,jdbcType=INTEGER},
            </if>
            <if test="brokerProperty != null">
                #{brokerProperty,jdbcType=VARCHAR},
            </if>
            <if test="active != null">
                #{active,jdbcType=CHAR},
            </if>
            <if test="createTime != null">
                #{createTime,jdbcType=TIMESTAMP},
            </if>
            <if test="updateTime != null">
                #{updateTime,jdbcType=TIMESTAMP},
            </if>
            <if test="failedDetail != null">
                #{failedDetail,jdbcType=LONGVARCHAR},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective"
            parameterType="com.pamirs.tro.entity.domain.entity.MqIsolateConfig">
        <!-- WARNING - @mbggenerated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        update t_mq_isolate_config
        <set>
            <if test="clusterName != null">
                CLUSTER_NAME = #{clusterName,jdbcType=VARCHAR},
            </if>
            <if test="clusterAlias != null">
                CLUSTER_ALIAS = #{clusterAlias,jdbcType=VARCHAR},
            </if>
            <if test="namesrvAddr != null">
                NAMESRV_ADDR = #{namesrvAddr,jdbcType=VARCHAR},
            </if>
            <if test="ptNamesrvAddr != null">
                PT_NAMESRV_ADDR = #{ptNamesrvAddr,jdbcType=VARCHAR},
            </if>
            <if test="brokerName != null">
                BROKER_NAME = #{brokerName,jdbcType=VARCHAR},
            </if>
            <if test="topic != null">
                TOPIC = #{topic,jdbcType=VARCHAR},
            </if>
            <if test="consumerGroup != null">
                CONSUMER_GROUP = #{consumerGroup,jdbcType=VARCHAR},
            </if>
            <if test="isolatedStatus != null">
                ISOLATED_STATUS = #{isolatedStatus,jdbcType=INTEGER},
            </if>
            <if test="brokerProperty != null">
                BROKER_PROPERTY = #{brokerProperty,jdbcType=VARCHAR},
            </if>
            <if test="active != null">
                ACTIVE = #{active,jdbcType=CHAR},
            </if>
            <if test="createTime != null">
                CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
            </if>
            <if test="updateTime != null">
                UPDATE_TIME = #{updateTime,jdbcType=TIMESTAMP},
            </if>
            <if test="failedDetail != null">
                FAILED_DETAIL = #{failedDetail,jdbcType=LONGVARCHAR},
            </if>
        </set>
        where ID = #{id,jdbcType=BIGINT}
    </update>
    <update id="updateByPrimaryKeyWithBLOBs"
            parameterType="com.pamirs.tro.entity.domain.entity.MqIsolateConfig">
        <!-- WARNING - @mbggenerated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        update t_mq_isolate_config
        set CLUSTER_NAME = #{clusterName,jdbcType=VARCHAR},
        CLUSTER_ALIAS = #{clusterAlias,jdbcType=VARCHAR},
        NAMESRV_ADDR = #{namesrvAddr,jdbcType=VARCHAR},
        PT_NAMESRV_ADDR = #{ptNamesrvAddr,jdbcType=VARCHAR},
        BROKER_NAME = #{brokerName,jdbcType=VARCHAR},
        TOPIC = #{topic,jdbcType=VARCHAR},
        CONSUMER_GROUP = #{consumerGroup,jdbcType=VARCHAR},
        ISOLATED_STATUS = #{isolatedStatus,jdbcType=INTEGER},
        BROKER_PROPERTY = #{brokerProperty,jdbcType=VARCHAR},
        ACTIVE = #{active,jdbcType=CHAR},
        CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
        UPDATE_TIME = #{updateTime,jdbcType=TIMESTAMP},
        FAILED_DETAIL = #{failedDetail,jdbcType=LONGVARCHAR}
        where ID = #{id,jdbcType=BIGINT}
    </update>
    <update id="updateByPrimaryKey"
            parameterType="com.pamirs.tro.entity.domain.entity.MqIsolateConfig">
        <!-- WARNING - @mbggenerated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        update t_mq_isolate_config
        set CLUSTER_NAME = #{clusterName,jdbcType=VARCHAR},
        CLUSTER_ALIAS = #{clusterAlias,jdbcType=VARCHAR},
        NAMESRV_ADDR = #{namesrvAddr,jdbcType=VARCHAR},
        PT_NAMESRV_ADDR = #{ptNamesrvAddr,jdbcType=VARCHAR},
        BROKER_NAME = #{brokerName,jdbcType=VARCHAR},
        TOPIC = #{topic,jdbcType=VARCHAR},
        CONSUMER_GROUP = #{consumerGroup,jdbcType=VARCHAR},
        ISOLATED_STATUS = #{isolatedStatus,jdbcType=INTEGER},
        BROKER_PROPERTY = #{brokerProperty,jdbcType=VARCHAR},
        ACTIVE = #{active,jdbcType=CHAR},
        CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
        UPDATE_TIME = #{updateTime,jdbcType=TIMESTAMP}
        where ID = #{id,jdbcType=BIGINT}
    </update>


    <update id="deleteMqIsolateConfig"
            parameterType="com.pamirs.tro.entity.domain.entity.MqDeleteDTO">
        update t_mq_isolate_config
        set
        UPDATE_TIME = #{updateTime,jdbcType=TIMESTAMP},
        ACTIVE = 'N' WHERE ID IN

        <foreach close=")" collection="ids" index="index" item="id"
                 open="(" separator=",">
            #{id}
        </foreach>
    </update>

    <select id="queryConfigExsit" resultType="java.lang.Integer"
            parameterType="com.pamirs.tro.entity.domain.entity.MqIsolateConfig">
        <!-- WARNING - @mbggenerated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        select count(1) from t_mq_isolate_config
        where CLUSTER_NAME = #{clusterName,jdbcType=BIGINT}
        AND ACTIVE='Y'
    </select>

    <select id="queryMqIsolateConfigs"
            resultMap="ResultMapWithBLOBs"
            parameterType="com.pamirs.tro.entity.domain.entity.MqIsolateConfig">
        <!-- WARNING - @mbggenerated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        select
        <include refid="Base_Column_List"/>
        ,
        <include refid="Blob_Column_List"/>
        from t_mq_isolate_config

        <where>
            ACTIVE='Y'
            <if test="clusterName != null and clusterName !=''">
                AND CLUSTER_NAME LIKE CONCAT ('%', #{clusterName,jdbcType=VARCHAR},'%')

            </if>
            <if test="clusterAlias != null and clusterAlias !=''">
                AND CLUSTER_ALIAS LIKE CONCAT ('%',
                #{clusterAlias,jdbcType=VARCHAR},'%')
            </if>
            <if test="namesrvAddr != null and namesrvAddr != ''">
                AND NAMESRV_ADDR LIKE CONCAT ('%', #{namesrvAddr,jdbcType=VARCHAR},'%')
            </if>
            <if test="ptNamesrvAddr != null and ptNamesrvAddr != ''">
                AND PT_NAMESRV_ADDR LIKE CONCAT ('%',
                #{ptNamesrvAddr,jdbcType=VARCHAR},'%')
            </if>
            <if test="brokerName != null and brokerName != ''">
                AND BROKER_NAME LIKE CONCAT('%', #{brokerName,jdbcType=VARCHAR},'%')
            </if>
            <if test="isolatedStatus != null and isolatedStatus != ''">
                AND ISOLATED_STATUS = #{isolatedStatus,jdbcType=INTEGER}
            </if>
        </where>
    </select>

    <select id="queryMqIsolateConfig" parameterType="java.util.List"
            resultMap="ResultMapWithBLOBs">
        SELECT
        <include refid="Base_Column_List"/>
        ,
        <include refid="Blob_Column_List"/>
        from t_mq_isolate_config
        WHERE ID IN
        <foreach collection="ids" item="id" index="index" open="("
                 close=")" separator=",">
            #{id}
        </foreach>
        AND ACTIVE = 'Y'
    </select>


    <select id="queryAllActiveMqIsolateConfig" resultMap="ResultMapWithBLOBs">
        SELECT
        <include refid="Base_Column_List"/>
        ,
        <include refid="Blob_Column_List"/>
        from t_mq_isolate_config
        WHERE ACTIVE = 'Y'
    </select>


</mapper>
